<!DOCTYPE html>
<html>
<head>
    <title>用户信息修改</title>
    <meta charset="UTF-8">
    <script th:src="@{/script/jquery-3.6.0.min.js}"></script>
    <link href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.21/dist/vue.js"></script>
</head>

<body>

<div class="container" id="update">
    <!--标题-->
    <div class="row clearfix">
        <div class="col-md-12 column">
            <div class="page-header">
                <h1>
                    <small>信息修改</small>
                </h1>
            </div>
        </div>
    </div>

    <div class="form-group">
        <label>用户ID：</label>
        <input type="text" class="form-control" th:value="${user.id}" ref="id" required disabled>
    </div>

    <div class="form-group">
        <label><span style="color:red">*</span>用户姓名：</label>
        <input type="text" class="form-control"
               maxlength="10"
               oninput="value=value.replace(/[^\a-\z\A-\Z0-9\u4E00-\u9FA5\ ]/g,'')"
               placeholder="用户名称由1-10个字符组成，只能包括中文、英文和数字"
               th:value="${user.name}" ref="name" required>
    </div>

    <div class="form-group">
        <label><span style="color:red">*</span>用户年龄：</label>
        <input type="text" class="form-control"
               oninput = "value=value.replace(/[^\d]/g,'');if(value>150)value=150"
               placeholder="年龄栏只能输入纯数字，且范围为0-150"
               th:value="${user.age}" ref="age" required>
    </div>

    <div class="form-group">
        <label>详细描述：</label>
        <input type="text" class="form-control"
               maxlength="100"
               oninput="value=value.replace(/[^\a-\z\A-\Z0-9\u4E00-\u9FA5\ ]/g,'')"
               placeholder="100字以内，只能包含中文、英文和数字，可不填写"
               th:value="${user.detail}" ref="detail" required>
    </div>

    <div class="form-group">
        <label>创建日期：</label>
        <input type="text" class="form-control" th:value="${user.createdDate}" required disabled>
    </div>

    <button class="btn btn-default" v-on:click="update">修改</button>

    <span style="color:red">{{error}}</span>
</div>

<script>
    let vm = new Vue({
        el: '#update',
        data: {
          error: ''
        },
        methods: {
            update: function () {
                if(this.$refs.name.value === '' || this.$refs.age.value === '') {
                    this.error= "请完善您的信息"
                } else {
                    $.post("/update",
                        {
                            id: this.$refs.id.value,
                            name: this.$refs.name.value,
                            age: this.$refs.age.value,
                            detail: this.$refs.detail.value
                        }
                    );
                    window.location.href="/all";
                }
            }
        }
    });
</script>

</body>
</html>

